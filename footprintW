<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WaterPrinx - Sample Frontend Preview</title>
  <style>
    /* Global & Reset */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4fa;
      color: #222;
      line-height: 1.5;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      background: #0a74da;
      color: white;
      padding: 1rem 2rem;
      box-shadow: 0 2px 6px rgb(10 116 218 / 0.4);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 100;
    }
    header h1 {
      margin: 0;
      font-weight: 700;
      font-size: 1.5rem;
      cursor: default;
    }
    nav button {
      background: #1e90ff;
      border: none;
      color: white;
      font-weight: 600;
      margin-left: 10px;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    nav button:hover {
      background: #145ea8;
    }

    main {
      max-width: 900px;
      width: 95%;
      margin-top: 80px;
      padding: 1rem 1.5rem 3rem 1.5rem;
      background: white;
      border-radius: 10px;
      box-shadow: 0 8px 18px rgb(0 0 0 / 0.1);
      min-height: 70vh;
    }

    /* Main page styles */
    #main-page h2 {
      margin-top: 0;
      font-weight: 700;
      color: #0a74da;
    }
    #main-page .input-group {
      margin-bottom: 1.5rem;
    }
    #main-page label {
      font-weight: 600;
      display: block;
      margin-bottom: 0.5rem;
    }
    #main-page select, #main-page input[type=number] {
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #main-page button {
      background: #0a74da;
      color: white;
      padding: 0.75rem 1.5rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #main-page button:hover {
      background: #064a85;
    }
    #output {
      margin-top: 2rem;
      font-size: 1.25rem;
      font-weight: 600;
      color: #222;
      min-height: 2em;
    }

    /* Settings page styles */
    #settings-page h2 {
      margin-top: 0;
      font-weight: 700;
      color: #0a74da;
    }
    #settings-page label {
      font-weight: 600;
      margin-top: 1rem;
      display: block;
    }
    #settings-page select, #settings-page input[type=text] {
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-top: 0.25rem;
    }
    #settings-page button {
      background: #0a74da;
      color: white;
      margin-top: 1rem;
      padding: 0.5rem 1.2rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #settings-page button:hover {
      background: #064a85;
    }
    #dropdown-list {
      background: #f6f9ff;
      border-radius: 8px;
      max-height: 180px;
      overflow-y: auto;
      margin-top: 0.5rem;
      padding: 0.5rem;
      border: 1px solid #ccc;
    }
    #dropdown-list div {
      padding: 0.3rem 0.6rem;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #dropdown-list div:last-child {
      border-bottom: none;
    }
    .remove-item-btn {
      background: #e74c3c;
      border: none;
      color: white;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      cursor: pointer;
      font-weight: bold;
      line-height: 22px;
      text-align: center;
      padding: 0;
      margin-left: 12px;
      transition: background-color 0.3s ease;
    }
    .remove-item-btn:hover {
      background: #b43127;
    }

    /* Graph page styles */
    #graph-page h2 {
      margin-top: 0;
      font-weight: 700;
      color: #0a74da;
      margin-bottom: 1rem;
    }
    #graph-container {
      width: 100%;
      max-width: 860px;
      height: 400px;
    }

    /* Responsive */
    @media (max-width: 600px) {
      main {
        padding: 1rem 1rem 3rem 1rem;
      }
      #graph-container {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>WaterPrinx</h1>
    <nav>
      <button onclick="navigate('main')">Main Page</button>
      <button onclick="navigate('settings')">Settings</button>
      <button onclick="navigate('graph')">Usage Graph</button>
    </nav>
  </header>

  <main>
    <!-- Main Page -->
    <section id="main-page" style="display: none;">
      <h2>Calculate Water Footprint</h2>
      <div class="input-group">
        <label for="item-select">Select Item</label>
        <select id="item-select"></select>
      </div>
      <div class="input-group">
        <label for="quantity-input">Quantity / Usage</label>
        <input type="number" id="quantity-input" min="1" value="1" />
      </div>
      <button onclick="calculateFootprint()">Calculate Footprint</button>
      <div id="output"></div>
    </section>

    <!-- Settings Page -->
    <section id="settings-page" style="display: none;">
      <h2>Edit Item List</h2>
      <label for="new-item-input">Add New Item</label>
      <input type="text" id="new-item-input" placeholder="Enter new item name" />
      <button onclick="addItem()">Add Item</button>

      <div id="dropdown-list" aria-live="polite"></div>
    </section>

    <!-- Graph Page -->
    <section id="graph-page" style="display: none;">
      <h2>Weekly Water Usage (Litres)</h2>
      <canvas id="usage-chart"></canvas>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Initial items for dropdown - can be edited in settings
    let itemList = ['Shower', 'Toilet Flush', 'Washing Machine', 'Dishwasher', 'Cooking', 'Drinking'];

    // Example footprint values (litres per unit)
    const footprintValues = {
      'Shower': 50,
      'Toilet Flush': 8,
      'Washing Machine': 70,
      'Dishwasher': 15,
      'Cooking': 10,
      'Drinking': 2
    };

    // Save dropdown to localStorage for persistence (optional)
    function saveItems() {
      localStorage.setItem('waterprinx_items', JSON.stringify(itemList));
    }
    function loadItems() {
      const saved = localStorage.getItem('waterprinx_items');
      if (saved) {
        itemList = JSON.parse(saved);
      }
    }

    // Populate dropdown on main page
    function populateDropdown() {
      const select = document.getElementById('item-select');
      select.innerHTML = '';
      itemList.forEach(item => {
        const option = document.createElement('option');
        option.value = item;
        option.textContent = item;
        select.appendChild(option);
      });
    }

    // Render item list in settings page with remove buttons
    function renderSettingsList() {
      const list = document.getElementById('dropdown-list');
      list.innerHTML = '';
      itemList.forEach((item, idx) => {
        const div = document.createElement('div');
        div.textContent = item;
        const btn = document.createElement('button');
        btn.textContent = 'Ã—';
        btn.setAttribute('aria-label', `Remove ${item}`);
        btn.className = 'remove-item-btn';
        btn.onclick = () => {
          itemList.splice(idx, 1);
          saveItems();
          renderSettingsList();
          populateDropdown();
        };
        div.appendChild(btn);
        list.appendChild(div);
      });
    }

    // Add item from input in settings
    function addItem() {
      const input = document.getElementById('new-item-input');
      let val = input.value.trim();
      if (val && !itemList.includes(val)) {
        itemList.push(val);
        saveItems();
        renderSettingsList();
        populateDropdown();
        input.value = '';
      } else {
        alert('Input is empty or item already exists.');
      }
    }

    // Calculate footprint on Main page
    function calculateFootprint() {
      const item = document.getElementById('item-select').value;
      const qty = parseInt(document.getElementById('quantity-input').value);
      if (!qty || qty <= 0) {
        alert('Please enter a valid quantity.');
        return;
      }
      const footprint = (footprintValues[item] || 10) * qty; // default 10L if unknown
      const output = document.getElementById('output');
      output.textContent = `Estimated water footprint for ${qty} ${item}(s): ${footprint.toLocaleString()} litres`;
    }

    // Page navigation logic
    function navigate(page) {
      ['main-page', 'settings-page', 'graph-page'].forEach(id => {
        document.getElementById(id).style.display = (id === page + '-page') ? 'block' : 'none';
      });
      if (page === 'main') {
        populateDropdown();
      } else if (page === 'settings') {
        renderSettingsList();
      } else if (page === 'graph') {
        renderGraph();
      }
    }

    // Chart.js bar chart sample for weekly usage
    let chartInstance = null;
    function renderGraph() {
      const ctx = document.getElementById('usage-chart').getContext('2d');
      if (chartInstance) {
        chartInstance.destroy();
      }
      // Sample weekly data for items usage in litres
      const weeklyData = {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: []
      };
      // Generate random sample data for each item in itemList
      itemList.forEach((item, idx) => {
        weeklyData.datasets.push({
          label: item,
          backgroundColor: `hsl(${(idx * 60) % 360}, 70%, 55%)`,
          data: Array.from({ length: 7 }, () => Math.floor(Math.random() * 100) + 10)
        });
      });

      chartInstance = new Chart(ctx, {
        type: 'bar',
        data: weeklyData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          stacked: true,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Water Usage (litres)'
              }
            },
            x: {
              title: {
                display: true,
                text: 'Day of Week'
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: { boxWidth: 18, padding: 10 }
            },
            tooltip: {
              mode: 'index',
              intersect: false
            }
          }
        }
      });
    }

    // Initial setup
    window.onload = () => {
      loadItems();
      navigate('main');
    };
  </script>
</body>
</html>
